<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>My First Card Host</title>
    <script
      id="sap-ui-bootstrap"
      src="https://ui5.sap.com/resources/sap-ui-core.js"
      data-sap-ui-theme="sap_horizon"
      data-sap-ui-libs="sap.ui.integration, sap.m"
      data-sap-ui-async="true"
    ></script>
  </head>
  <body class="sapUiBody">
    <div style="display: flex; gap: 20px; padding: 2rem">
      <div id="magicContainer" style="width: 400px"></div>
      <div id="miracleContainer" style="width: 400px"></div>
    </div>

    <script>
      window.onload = function () {
        sap.ui.getCore().attachInit(() => {
          sap.ui.loader.config({
            paths: {
              magicCard: './magicCard',
              miracleCard: './miracleCard',
            },
          })
          sap.ui.require(['sap/ui/integration/widgets/Card'], Card => {
            // Первая карточка (Список)
            const oMagicCard = new Card('magicCard', {
              manifest: './magicCard/manifest.json',
              action: function (oEvent) {
                const oParameters = oEvent.getParameter('parameters')
                if (oParameters && oParameters.selectedId) {
                  const sId = oParameters.selectedId
                  console.log(`Хост поймал ID ${sId} через action`)

                  // Теперь мы можем просто обновить параметры второй карточки!
                  const oMiracleCard = sap.ui.getCore().byId('miracleCard')
                  oMiracleCard.setParameters({
                    todoId: sId,
                  })
                }
              },
            })
            oMagicCard.placeAt('magicContainer')

            // Вторая карточка (Детали) - пока укажем тот же манифест для теста
            const oMiracleCard = new Card('miracleCard', {
              manifest: './miracleCard/manifest.json',
            })
            oMiracleCard.placeAt('miracleContainer')
          })
        })
      }
    </script>
  </body>
</html>
